<?xml version="1.0" encoding="utf-8"?>
<Templates format="2" protocolVersion="62">
	<Template id="103c7317-bbbc-4f58-918f-f96479ad8cb2" revision="1.0">
		<Name>Shelly 1PM</Name>
		<CcuModel>PacketParserCCU</CcuModel>
		<Description></Description>
		<RevisionHistory>
			<Revision id="1.0">Initial version</Revision>
		</RevisionHistory>
		<ImportParameters>
			<Parameter>
				<Name>${ipAddress}</Name>
				<Value>192.168.0.1</Value>
				<Id>IpAddress</Id>
			</Parameter>
		</ImportParameters>
		<Module>
			<Name>Shelly 1PM Module</Name>
			<Model>PacketParserModule</Model>
			<DeviceProperties>
				<IpAddress>$[IpAddress]</IpAddress>
				<Port>80</Port>
				<ConnectionType>http</ConnectionType>
				<InternalPollInterval>2500</InternalPollInterval>
				<ReadRequest>{"Path":{"Script":"status","IsPlainText":true},"Content":{"Script":null,"IsPlainText":true},"Headers":{"Script":null,"IsPlainText":true},"Method":"GET","Mode":2,"ParseScript":null}</ReadRequest>
				<ServiceAttributesRequests>[{"AttributeDefinition":{"Name":"Power protection","Section":null},"ReadFormula":"{\"Path\":{\"Script\":\"settings\",\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":2,\"ParseScript\":\"PARSEJSON(ATTRIBUTERESPONSE, \\\"max_power\\\") + \\\"W\\\"\"}"},{"AttributeDefinition":{"Name":"${macAddress}","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"mac\\\")\"}"},{"AttributeDefinition":{"Name":"Device time","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"time\\\")\"}"},{"AttributeDefinition":{"Name":"Uptime","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"var upTimeSeconds := PARSEJSON(MAINATTRIBUTERESPONSE, \\\"uptime\\\");\\r\\nvar days := FLOOR(upTimeSeconds/86400, 1);\\r\\nuptimeSeconds := MOD(upTimeSeconds, 86400);\\r\\nvar hours := FLOOR(upTimeSeconds/3600, 1);\\r\\nuptimeSeconds := MOD(upTimeSeconds, 3600);\\r\\nvar minutes := FLOOR(upTimeSeconds/60, 1);\\r\\ndays + \\\"day(s) \\\" + hours + \\\"h \\\" + minutes + \\\"m\\\"\"}"},{"AttributeDefinition":{"Name":"RAM","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"var ramTotal := PARSEJSON(MAINATTRIBUTERESPONSE, \\\"ram_total\\\");\\r\\nvar ramFree := PARSEJSON(MAINATTRIBUTERESPONSE, \\\"ram_free\\\");\\r\\n\\r\\nramFree + \\\" bytes free of \\\" + ramTotal\"}"},{"AttributeDefinition":{"Name":"Internal device temperature","Section":null},"ReadFormula":"{\"Path\":{\"Script\":\"status\",\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"temperature\\\") + \\\"Â°C\\\"\"}"},{"AttributeDefinition":{"Name":"Temperature status","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"temperature_status\\\")\"}"},{"AttributeDefinition":{"Name":"FW update available","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"has_update\\\")\"}"},{"AttributeDefinition":{"Name":"Cloud enabled","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"cloud.enabled\\\")\"}"},{"AttributeDefinition":{"Name":"Cloud connected","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"cloud.connected\\\")\"}"},{"AttributeDefinition":{"Name":"MQTT connected","Section":null},"ReadFormula":"{\"Path\":{\"Script\":null,\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"mqtt.connected\\\")\"}"},{"AttributeDefinition":{"Name":"Overheated","Section":null},"ReadFormula":"{\"Path\":{\"Script\":\"status\",\"IsPlainText\":true},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":1,\"ParseScript\":\"PARSEJSON(MAINATTRIBUTERESPONSE, \\\"overtemperature\\\")\"}"}]</ServiceAttributesRequests>
				<ServiceActionsRequests>[{"ActionDefinition":{"Name":"Set power protection","NumericParameters":[{"FriendlyName":"powerLimit","Abbreviation":"Watts","IsFloat":false,"MinValue":0.0,"MaxValue":3500.0}],"BoolParameters":[],"EnumParameters":[]},"Script":"{\"Path\":{\"Script\":\"\\\"settings?max_power=\\\" + Watts\",\"IsPlainText\":false},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":2,\"ParseScript\":\"var actualMaxPower := PARSEJSON(ACTIONRESPONSE,\\\"max_power\\\");\\r\\n\\\"Power protection set to \\\" + actualMaxPower + \\\"W\\\"\"}"},{"ActionDefinition":{"Name":"Enable cloud","NumericParameters":[],"BoolParameters":[{"FriendlyName":"enable","Abbreviation":"enable","OffValueName":"${general_off}","OnValueName":"${general_on}"}],"EnumParameters":[]},"Script":"{\"Path\":{\"Script\":\"\\\"settings/cloud?enabled=\\\" + enable\",\"IsPlainText\":false},\"Content\":{\"Script\":null,\"IsPlainText\":true},\"Headers\":{\"Script\":null,\"IsPlainText\":true},\"Method\":\"GET\",\"Mode\":2,\"ParseScript\":\"var enabled := PARSEJSON(ACTIONRESPONSE,\\\"enabled\\\");\\r\\n\\\"Cloud enabled: \\\" + IF(enabled, \\\"true\\\", \\\"false\\\");\"}"}]</ServiceActionsRequests>
				<ServiceAttributesMainRequest>{"Path":{"Script":"status","IsPlainText":true},"Content":{"Script":null,"IsPlainText":true},"Headers":{"Script":null,"IsPlainText":true},"Method":"GET","Mode":2,"ParseScript":null}</ServiceAttributesMainRequest>
			</DeviceProperties>
			<Devices>
				<Device>
					<Name>Shelly 1PM Switch</Name>
					<Model>PacketParserSwitch</Model>
					<DeviceProperties>
						<InternalPollInterval>2500</InternalPollInterval>
						<OnStateIconId>60</OnStateIconId>
						<OffStateIconId>61</OffStateIconId>
						<OnStateName>${general_on}</OnStateName>
						<OffStateName>${general_off}</OffStateName>
						<ReadSwitchStateRequest>{"Path":{"Script":null,"IsPlainText":true},"Content":{"Script":null,"IsPlainText":true},"Headers":{"Script":null,"IsPlainText":true},"Method":"GET","Mode":1,"ParseScript":"PARSEJSON(MODULERESPONSE, \"relays[0].ison\")"}</ReadSwitchStateRequest>
						<WriteSwitchStateRequest>{"Path":{"Script":"\"relay/0?turn=\" + SWITCH(St, 0, \"off\", 1, \"on\",\"off\")","IsPlainText":false},"Content":{"Script":null,"IsPlainText":true},"Headers":{"Script":null,"IsPlainText":true},"Method":"GET","Mode":2,"ParseScript":null}</WriteSwitchStateRequest>
					</DeviceProperties>
				</Device>
				<Device>
					<Name>Shelly 1PM Power</Name>
					<Model>PacketParserElectricityMeter</Model>
					<DeviceProperties>
						<InternalPollInterval>2500</InternalPollInterval>
						<ReadTotalConsumptionRequest>{"Path":{"Script":null,"IsPlainText":true},"Content":{"Script":null,"IsPlainText":true},"Headers":{"Script":null,"IsPlainText":true},"Method":"GET","Mode":1,"ParseScript":"PARSEJSON(MODULERESPONSE, \"meters[0].total\") / 60000.0"}</ReadTotalConsumptionRequest>
						<ReadDemandRequest>{"Path":{"Script":null,"IsPlainText":true},"Content":{"Script":null,"IsPlainText":true},"Headers":{"Script":null,"IsPlainText":true},"Method":"GET","Mode":1,"ParseScript":"PARSEJSON(MODULERESPONSE, \"meters[0].power\") / 1000.0"}</ReadDemandRequest>
					</DeviceProperties>
				</Device>
			</Devices>
		</Module>
	</Template>
</Templates>
